name: Update submodule to latest

on:
    workflow_dispatch:

permissions:
  contents: write
  
jobs:
    reset-submodule:
        runs-on: ubuntu-latest

        steps:
        - name: Checkout repository
          uses: actions/checkout@v4
          with:
            token: ${{ secrets.CI_TOKEN }}
            submodules: recursive
            fetch-depth: 0

        - name: Reset submodule
          run: |
                git config --global --add --bool push.autoSetupRemote true
                git config --global user.name 'github-actions[bot]'
                git config --global user.email 'github-actions[bot]@users.noreply.github.com'
                
                # Ensure we're on the right branch
                git checkout main
                
                # Update submodule
                cd themes/adritian-free-hugo-theme
                git fetch origin main
                git checkout main
                git reset --hard origin/main
                cd ../..
                
                # Commit and push changes
                git add themes/adritian-free-hugo-theme
                git commit -m "Update theme submodule to main"
                git push origin main